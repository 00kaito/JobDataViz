# Dashboard Analizy Ofert Pracy

Kompleksowe narzƒôdzie do analizy rynku pracy w Polsce wykorzystujƒÖce framework Dash z uwierzytelnianiem opartym na rolach u≈ºytkownik√≥w. Aplikacja umo≈ºliwia interaktywnƒÖ analizƒô ofert pracy, trend√≥w wynagrodze≈Ñ, analizƒô umiejƒôtno≈õci i rozmieszczenie geograficzne ofert.

## üöÄ G≈Ç√≥wne Funkcjonalno≈õci

### Uwierzytelnianie i ZarzƒÖdzanie U≈ºytkownikami
- **System r√≥l**: `viewer`, `analyst`, `admin`
- **Logowanie**: Email + has≈Ço
- **Rejestracja**: Automatyczne generowanie nazwy u≈ºytkownika z imienia i emaila
- **Personalizacja**: Wyb√≥r preferowanej bran≈ºy zatrudnienia
- **Panel administracyjny**: ZarzƒÖdzanie u≈ºytkownikami (tylko admin)

### Analiza Danych
- **Upload danych**: Wsparcie dla plik√≥w JSON z ofertami pracy
- **Interaktywne wizualizacje**: Wykresy s≈Çupkowe, scatter plots, mapy cieplne
- **Filtrowanie danych**: Zaawansowane opcje filtrowania po r√≥≈ºnych kryteriach
- **Eksport wynik√≥w**: Mo≈ºliwo≈õƒá eksportu analiz

## üìä Widoki i Zak≈Çadki

### 1. **Analiza Umiejƒôtno≈õci** (Skills Analysis)
- Top 20 najpopularniejszych umiejƒôtno≈õci
- Kombinacje umiejƒôtno≈õci i ich wsp√≥≈Çwystƒôpowanie
- Wagowa analiza umiejƒôtno≈õci wed≈Çug poziomu do≈õwiadczenia
- Wykresy s≈Çupkowe i tabele z danymi

### 2. **Poziomy Do≈õwiadczenia** (Experience Levels)
- Rozk≈Çad ofert wed≈Çug wymaga≈Ñ do≈õwiadczenia
- Korelacja do≈õwiadczenia z wynagrodzeniem
- Wykresy ko≈Çowe i histogramy

### 3. **Analiza Geograficzna** (Location Analysis)
- Mapa cieplna ofert pracy wed≈Çug lokalizacji
- Ranking miast wed≈Çug liczby ofert
- Analiza zdalnej pracy vs praca w biurze

### 4. **Analiza Firm** (Company Analysis)
- Ranking firm wed≈Çug liczby publikowanych ofert
- Analiza wielko≈õci firm (startup, korporacje, SME)
- Preferencje firm w zakresie umiejƒôtno≈õci

### 5. **Trendy Rynkowe** (Market Trends)
- Zmiany w czasie popularno≈õci umiejƒôtno≈õci
- Sezonowo≈õƒá publikowania ofert
- Emerging skills i technologie

### 6. **Analiza Wynagrodze≈Ñ** (Salary Analysis)
- Rozk≈Çad wynagrodze≈Ñ wed≈Çug pozycji i do≈õwiadczenia
- Box plots i histogramy wynagrodze≈Ñ
- Korelacja wynagrodzenia z umiejƒôtno≈õciami

### 7. **Szczeg√≥≈Çowa Analiza Umiejƒôtno≈õci** (Detailed Skills)
- Deep-dive w konkretne umiejƒôtno≈õci
- Analiza kombinacji umiejƒôtno≈õci
- Matryca korelacji miƒôdzy umiejƒôtno≈õciami

## üèóÔ∏è Architektura Systemu

### Backend
```
Flask Server (server.py)
‚îú‚îÄ‚îÄ Authentication (auth.py)
‚îÇ   ‚îú‚îÄ‚îÄ Login/Register routes
‚îÇ   ‚îú‚îÄ‚îÄ Role-based access control
‚îÇ   ‚îî‚îÄ‚îÄ Session management
‚îú‚îÄ‚îÄ Database Models (models.py)
‚îÇ   ‚îú‚îÄ‚îÄ User model with roles
‚îÇ   ‚îú‚îÄ‚îÄ UserSession for tracking
‚îÇ   ‚îî‚îÄ‚îÄ SQLAlchemy ORM
‚îî‚îÄ‚îÄ Admin Panel
    ‚îú‚îÄ‚îÄ User management
    ‚îú‚îÄ‚îÄ Data upload (admin only)
    ‚îî‚îÄ‚îÄ System monitoring
```

### Frontend - Dash Application
```
Dash App (app.py)
‚îú‚îÄ‚îÄ Protected Layout (authentication required)
‚îú‚îÄ‚îÄ Multi-tab Interface
‚îú‚îÄ‚îÄ Interactive Visualizations (visualizations.py)
‚îú‚îÄ‚îÄ Data Processing (data_processor.py)
‚îî‚îÄ‚îÄ Client-side Data Stores
```

### Komponenty

#### 1. **DataProcessor** (`data_processor.py`)
```python
class DataProcessor:
    - load_data_from_json()    # Wczytywanie danych JSON
    - validate_data()          # Walidacja struktury danych
    - process_skills()         # Analiza umiejƒôtno≈õci
    - calculate_statistics()   # Obliczenia statystyczne
    - filter_data()           # Filtrowanie danych
```

#### 2. **ChartGenerator** (`visualizations.py`)
```python
class ChartGenerator:
    - create_skills_chart()      # Wykresy umiejƒôtno≈õci
    - create_salary_analysis()   # Analiza wynagrodze≈Ñ
    - create_location_map()      # Mapy geograficzne
    - create_correlation_matrix() # Matryce korelacji
    - create_trend_analysis()    # Analiza trend√≥w
```

#### 3. **User Model** (`models.py`)
```python
class User:
    - id, username, email, first_name
    - password_hash (bcrypt)
    - role (viewer/analyst/admin)
    - preferred_category
    - created_at, is_active
    
    Methods:
    - can_access_advanced()  # Sprawdza dostƒôp do zaawansowanych funkcji
    - can_access_admin()     # Sprawdza uprawnienia administratora
```

### Struktura R√≥l

| Rola | Dostƒôp | Opis |
|------|---------|------|
| `viewer` | Podstawowe zak≈Çadki | PrzeglƒÖdanie analiz, ograniczony dostƒôp |
| `analyst` | Wszystkie analiz | Pe≈Çny dostƒôp do wszystkich wizualizacji |
| `admin` | Pe≈Çny dostƒôp + zarzƒÖdzanie | Upload danych, zarzƒÖdzanie u≈ºytkownikami |

## üõ†Ô∏è Technologie

### Backend
- **Flask** - Web framework
- **SQLAlchemy** - ORM dla bazy danych
- **Flask-Login** - ZarzƒÖdzanie sesjami
- **PostgreSQL** - Baza danych (Replit/Docker)
- **Werkzeug** - Password hashing i proxy

### Frontend/Visualization
- **Dash** - Framework do aplikacji analitycznych
- **Plotly** - Interaktywne wykresy
- **Dash Bootstrap Components** - UI komponenty
- **Bootstrap** - CSS framework (dark theme)
- **Font Awesome** - Ikony

### Data Processing
- **Pandas** - Manipulacja i analiza danych
- **NumPy** - Obliczenia numeryczne
- **Collections** - Counter dla analizy czƒôsto≈õci

## üêß Instalacja Lokalna (Ubuntu z PostgreSQL w Docker)

### 1. Wymagania systemowe
- **System operacyjny**: Ubuntu 20.04 lub nowszy
- **Python**: 3.11 lub nowszy
- **Docker**: Do uruchomienia bazy danych PostgreSQL
- **Git**: Do klonowania repozytorium

### 2. Instalacja zale≈ºno≈õci systemowych

```bash
# Aktualizacja systemu
sudo apt update && sudo apt upgrade -y

# Instalacja Python 3.11 i narzƒôdzi
# Dla Ubuntu 20.04/22.04 - dodaj deadsnakes PPA dla Python 3.11
sudo add-apt-repository ppa:deadsnakes/ppa -y
sudo apt update
sudo apt install -y python3.11 python3.11-venv python3.11-dev python3-pip

# Alternatywnie, u≈ºyj systemowego Python 3.10+ (wystarczajƒÖcy):
# sudo apt install -y python3 python3-venv python3-dev python3-pip

# Instalacja Docker
sudo apt install -y apt-transport-https ca-certificates curl gnupg lsb-release
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io

# Dodanie u≈ºytkownika do grupy docker (wymaga ponownego logowania)
sudo usermod -aG docker $USER

# Instalacja dodatkowych narzƒôdzi do kompilacji
sudo apt install -y git curl build-essential libpq-dev
```

### 3. Uruchomienie bazy danych PostgreSQL w Docker

```bash
# Ponowne logowanie dla aktywacji grupy docker (lub u≈ºyj newgrp docker)
newgrp docker

# Generowanie bezpiecznego has≈Ça do bazy danych
DB_PASSWORD=$(python3 -c "import secrets, string; chars=string.ascii_letters+string.digits; print(''.join(secrets.choice(chars) for _ in range(20)))")

echo "‚úÖ Wygenerowane has≈Ço do bazy danych: ${DB_PASSWORD}"

# Utworzenie katalogu na dane PostgreSQL
mkdir -p pgdata

# Uruchomienie kontenera PostgreSQL z trwa≈Çym przechowywaniem danych
docker run -d \
  --name jobmarket-postgres \
  -e POSTGRES_DB=jobmarket \
  -e POSTGRES_USER=jobmarket \
  -e POSTGRES_PASSWORD=${DB_PASSWORD} \
  -e POSTGRES_INITDB_ARGS="--encoding=UTF8 --locale=C" \
  -p 127.0.0.1:5432:5432 \
  -v $(pwd)/pgdata:/var/lib/postgresql/data \
  --restart=unless-stopped \
  postgres:15

echo "‚úÖ Kontener PostgreSQL uruchomiony pomy≈õlnie"

# Sprawdzenie czy kontener dzia≈Ça
docker ps | grep jobmarket-postgres

# Oczekiwanie na gotowo≈õƒá bazy danych
echo "‚è≥ Oczekiwanie na gotowo≈õƒá PostgreSQL..."
until docker exec jobmarket-postgres pg_isready -U jobmarket -d jobmarket >/dev/null 2>&1; do
  echo -n "."
  sleep 1
done
echo ""
echo "‚úÖ PostgreSQL jest gotowy do po≈ÇƒÖcze≈Ñ"
```

### 4. Klonowanie i przygotowanie projektu

```bash
# Klonowanie repozytorium
git clone <repository-url>
cd job-market-dashboard

# Utworzenie ≈õrodowiska wirtualnego
python3.11 -m venv venv

# Aktywacja ≈õrodowiska wirtualnego
source venv/bin/activate

# Aktualizacja pip
pip install --upgrade pip setuptools wheel
```

### 5. Instalacja zale≈ºno≈õci Python

```bash
# Instalacja z pyproject.toml (zalecane)
pip install -e .
```

### 6. Konfiguracja zmiennych ≈õrodowiskowych

```bash
# Utworzenie pliku .env z wcze≈õniej wygenerowanym has≈Çem
cat > .env << EOF
DATABASE_URL=postgresql://jobmarket:${DB_PASSWORD}@localhost:5432/jobmarket
SESSION_SECRET=$(python3 -c "import secrets; print(secrets.token_hex(32))")
FLASK_ENV=development
PYTHONPATH=.
EOF

echo "‚úÖ Plik .env utworzony pomy≈õlnie"

# Wczytanie zmiennych (dla bie≈ºƒÖcej sesji) - bezpieczniejsza metoda
set -a
source .env
set +a

# Dla trwa≈Çej konfiguracji dodaj do ~/.bashrc (opcjonalnie)
echo "# Job Market Dashboard environment" >> ~/.bashrc
echo "set -a; source $(pwd)/.env; set +a" >> ~/.bashrc

# Sprawdzenie czy kontener PostgreSQL dzia≈Ça
if ! docker ps | grep jobmarket-postgres >/dev/null; then
  echo "‚ùå Kontener PostgreSQL nie dzia≈Ça - sprawd≈∫ krok 3"
else
  echo "‚úÖ Kontener PostgreSQL dzia≈Ça poprawnie"
fi
```

### 7. Inicjalizacja bazy danych

```bash
# Oczekiwanie na gotowo≈õƒá bazy danych
echo "‚è≥ Sprawdzanie po≈ÇƒÖczenia z bazƒÖ danych..."
until docker exec jobmarket-postgres pg_isready -U jobmarket -d jobmarket >/dev/null 2>&1; do
  echo -n "."
  sleep 1
done
echo ""

# Inicjalizacja bazy danych
python3 -c "
from app import app
from models import db, User
try:
    with app.app_context():
        db.create_all()
    print('‚úÖ Baza danych zosta≈Ça zainicjalizowana pomy≈õlnie')
except Exception as e:
    print(f'‚ùå B≈ÇƒÖd inicjalizacji bazy danych: {e}')
"
```

### 8. Uruchomienie aplikacji

#### Rozw√≥j (Development):
```bash
# Uruchomienie z Gunicorn (zalecane)
gunicorn --bind 0.0.0.0:5000 --reload --timeout 120 main:app

# Lub bezpo≈õrednio z Python (tylko do rozwoju)
python -c "from app import app; app.run(debug=True, host='0.0.0.0', port=5000)"
```

#### Produkcja:
```bash
# Utworzenie katalogu na logi
mkdir -p logs

# Uruchomienie z wieloma workerami
gunicorn --bind 0.0.0.0:5000 --workers 4 --timeout 120 main:app

# Z logowaniem
gunicorn --bind 0.0.0.0:5000 --workers 4 --timeout 120 \
         --access-logfile logs/access.log --error-logfile logs/error.log \
         main:app
```

### 9. Tworzenie us≈Çugi systemowej (opcjonalnie)

```bash
# Utworzenie pliku us≈Çugi systemd
sudo tee /etc/systemd/system/jobmarket.service > /dev/null << EOF
[Unit]
Description=Job Market Dashboard
After=network.target docker.service
Requires=docker.service

[Service]
Type=simple
User=$USER
WorkingDirectory=$(pwd)
Environment=PATH=$(pwd)/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
EnvironmentFile=$(pwd)/.env
ExecStartPre=/bin/bash -c '[ -n "$(docker ps -q -f name=^jobmarket-postgres$)" ] || docker start jobmarket-postgres'
ExecStartPre=/bin/bash -c 'until docker exec jobmarket-postgres pg_isready -U jobmarket -d jobmarket >/dev/null 2>&1; do sleep 1; done'
ExecStart=$(pwd)/venv/bin/gunicorn --bind 0.0.0.0:5000 --workers 4 main:app
Restart=always
RestartSec=3

[Install]
WantedBy=multi-user.target
EOF

# Uruchomienie us≈Çugi
sudo systemctl daemon-reload
sudo systemctl enable jobmarket
sudo systemctl start jobmarket

# Sprawdzenie statusu
sudo systemctl status jobmarket

# Logi us≈Çugi
sudo journalctl -u jobmarket -f
```

### 10. Weryfikacja instalacji

```bash
# Sprawdzenie czy aplikacja dzia≈Ça
curl http://localhost:5000

# Sprawdzenie log√≥w
tail -f logs/*.log

# Test po≈ÇƒÖczenia z bazƒÖ danych
python3 -c "
from app import app
from models import User
try:
    with app.app_context():
        print(f'‚úÖ Liczba u≈ºytkownik√≥w w bazie: {User.query.count()}')
except Exception as e:
    print(f'‚ùå B≈ÇƒÖd po≈ÇƒÖczenia z bazƒÖ: {e}')
"
```

### 11. Pierwszy Administrator

Po uruchomieniu aplikacji:
1. Przejd≈∫ do `http://localhost:5000` lub `http://server-ip:5000`
2. Kliknij "Zarejestruj siƒô"
3. Pierwszy u≈ºytkownik automatycznie otrzyma rolƒô administratora
4. Zaloguj siƒô u≈ºywajƒÖc emaila i has≈Ça

### RozwiƒÖzywanie problem√≥w

#### Problem z po≈ÇƒÖczeniem do PostgreSQL:
```bash
# Sprawdzenie czy kontener Docker dzia≈Ça
docker ps | grep jobmarket-postgres

# Sprawdzenie log√≥w kontenera
docker logs jobmarket-postgres

# Sprawdzenie port√≥w
sudo ss -tlnp | grep 5432

# Test po≈ÇƒÖczenia bezpo≈õrednio do kontenera
docker exec -it jobmarket-postgres psql -U jobmarket -d jobmarket

# Restart kontenera je≈õli potrzeba
docker restart jobmarket-postgres
```

#### Problem z uprawnieniami Python:
```bash
# Upewnienie siƒô ≈ºe ≈õrodowisko wirtualne jest aktywne
which python3
# Powinno pokazaƒá: /path/to/project/venv/bin/python3

# Reinstalacja zale≈ºno≈õci
pip install --upgrade --force-reinstall -e .
```

#### Problem z importami:
```bash
# Dodanie ≈õcie≈ºki projektu do PYTHONPATH
export PYTHONPATH="${PYTHONPATH}:$(pwd)"

# Sprawdzenie czy wszystkie modu≈Çy siƒô importujƒÖ
python3 -c "
try:
    import app, models, auth, forms, data_processor, visualizations
    print('‚úÖ Wszystkie modu≈Çy zaimportowane pomy≈õlnie')
except ImportError as e:
    print(f'‚ùå B≈ÇƒÖd importu: {e}')
"
```

## üê≥ Instalacja Lokalna (Docker)

### 1. Wymagania
- Docker
- Docker Compose
- Git

### 2. Klonowanie repozytorium
```bash
git clone <repository-url>
cd job-market-dashboard
```

### 3. Konfiguracja Docker

Utw√≥rz `Dockerfile`:
```dockerfile
FROM python:3.11-slim

WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \\
    gcc \\
    g++ \\
    && rm -rf /var/lib/apt/lists/*

# Copy requirements
COPY pyproject.toml ./
RUN pip install -U pip setuptools wheel
RUN pip install -e .

# Copy application files
COPY . .

# Create non-root user
RUN useradd --create-home --shell /bin/bash app
USER app

EXPOSE 5000

CMD ["gunicorn", "--bind", "0.0.0.0:5000", "--reuse-port", "--reload", "main:app"]
```

Utw√≥rz `docker-compose.yml`:
```yaml
version: '3.8'

services:
  db:
    image: postgres:15
    environment:
      POSTGRES_DB: jobmarket
      POSTGRES_USER: jobmarket
      POSTGRES_PASSWORD: jobmarket123
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  web:
    build: .
    ports:
      - "5000:5000"
    environment:
      DATABASE_URL: postgresql://jobmarket:jobmarket123@db:5432/jobmarket
      SESSION_SECRET: your-super-secret-key-change-this-in-production
      FLASK_ENV: development
    volumes:
      - .:/app
    depends_on:
      - db
    command: >
      sh -c "
        python -c 'from models import db; from app import app; 
        with app.app_context(): db.create_all()' &&
        gunicorn --bind 0.0.0.0:5000 --reload main:app
      "

volumes:
  postgres_data:
```

### 4. Uruchomienie
```bash
# Budowanie i uruchomienie
docker-compose up --build

# W tle
docker-compose up -d

# Sprawdzenie log√≥w
docker-compose logs -f web

# Zatrzymanie
docker-compose down
```

### 5. Pierwszy Administrator
Po uruchomieniu aplikacji:
1. Przejd≈∫ do `http://localhost:5000`
2. Kliknij "Zarejestruj siƒô"
3. Pierwszy u≈ºytkownik automatycznie otrzyma rolƒô administratora
4. Zaloguj siƒô u≈ºywajƒÖc emaila i has≈Ça

## üìÅ Struktura Plik√≥w

```
job-market-dashboard/
‚îú‚îÄ‚îÄ app.py                 # G≈Ç√≥wna aplikacja Dash
‚îú‚îÄ‚îÄ main.py               # Entry point dla Gunicorn
‚îú‚îÄ‚îÄ models.py             # Modele bazy danych
‚îú‚îÄ‚îÄ auth.py               # Uwierzytelnianie i autoryzacja
‚îú‚îÄ‚îÄ forms.py              # Formularze WTForms
‚îú‚îÄ‚îÄ data_processor.py     # Przetwarzanie danych
‚îú‚îÄ‚îÄ visualizations.py     # Generowanie wykres√≥w
‚îú‚îÄ‚îÄ templates/            # Szablony HTML
‚îÇ   ‚îú‚îÄ‚îÄ base.html
‚îÇ   ‚îú‚îÄ‚îÄ login.html
‚îÇ   ‚îú‚îÄ‚îÄ register.html
‚îÇ   ‚îî‚îÄ‚îÄ admin.html
‚îú‚îÄ‚îÄ assets/               # Statyczne pliki CSS/JS
‚îú‚îÄ‚îÄ docker-compose.yml    # Konfiguracja Docker
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ README.md
```

## üîß Konfiguracja ≈örodowiska

### Zmienne ≈örodowiskowe
```bash
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
SESSION_SECRET=your-secret-key
FLASK_ENV=development
```

### Pierwsze Uruchomienie
```bash
# Inicjalizacja bazy danych
python -c "from models import db; from app import app; with app.app_context(): db.create_all()"

# Uruchomienie serwera
gunicorn --bind 0.0.0.0:5000 main:app
```

## üìä Format Danych

Aplikacja oczekuje danych w formacie JSON:
```json
[
  {
    "title": "Python Developer",
    "company": "Tech Corp",
    "location": "Warszawa",
    "salary_min": 8000,
    "salary_max": 12000,
    "currency": "PLN",
    "experience_level": "Mid",
    "skills": ["Python", "Django", "PostgreSQL"],
    "category": "IT",
    "remote": true,
    "company_size": "Startup",
    "posted_date": "2024-01-15"
  }
]
```

## üö® Bezpiecze≈Ñstwo

- Has≈Ça u≈ºytkownik√≥w hashowane z Werkzeug
- Ochrona CSRF w formularzach
- Autoryzacja oparta na rolach
- Sesje zarzƒÖdzane przez Flask-Login
- SSL/TLS dla po≈ÇƒÖcze≈Ñ z bazƒÖ danych

## üîÑ Development

### Dodawanie Nowych Widok√≥w
1. Dodaj nowƒÖ zak≈Çadkƒô w `app.py` w sekcji `tabs`
2. Stw√≥rz callback do obs≈Çugi zawarto≈õci zak≈Çadki
3. Zaimplementuj logikƒô w `data_processor.py`
4. Dodaj wizualizacje w `visualizations.py`

### Testowanie
```bash
# Sprawd≈∫ czy aplikacja startuje
gunicorn --bind 0.0.0.0:5000 --reload main:app

# Test po≈ÇƒÖczenia z bazƒÖ
python -c "from app import app; from models import User; with app.app_context(): print(f'Liczba u≈ºytkownik√≥w: {User.query.count()}')"
```

## üìù Licencja

MIT License - Zobacz plik LICENSE dla szczeg√≥≈Ç√≥w.

## ü§ù Kontakt

Dla pyta≈Ñ dotyczƒÖcych developmentu lub architektury, skontaktuj siƒô z zespo≈Çem deweloperskim.